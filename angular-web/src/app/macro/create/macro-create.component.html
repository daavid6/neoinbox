<section class="container">
	<mat-card appearance="outlined">
		<mat-card-header>
			<mat-card-title>New Macro</mat-card-title>
		</mat-card-header>

		<mat-card-content>
			<mat-stepper class="stepper" [orientation]="(stepperOrientation | async)!">
				<mat-step label="Set a name for the Macro">
					<form>
						<mat-form-field>
							<mat-label>Macro's name</mat-label>
							<input matInput required />
						</mat-form-field>
						<div>
							<button type="button" mat-button matStepperNext>Next</button>
						</div>
					</form>
				</mat-step>

				<mat-step label="Select what to do">
					<form>
						<mat-grid-list class="mat-grid-list" cols="3" rowHeight="8rem">
							<mat-chip-listbox (change)="onOptionSelected($event)">
								@for (option of options; track option) {
									<mat-grid-tile
										[colspan]="option.cols"
										[rowspan]="option.rows"
										[style.background]="option.color"
									>
										<mat-chip-option [value]="option.text">{{
											option.text
										}}</mat-chip-option>
									</mat-grid-tile>
								}
							</mat-chip-listbox>
						</mat-grid-list>

						<div>
							<ng-content select="[selector]"></ng-content>
							<button type="button" mat-button matStepperPrevious>Back</button>
							<button type="button" mat-button matStepperNext>Next</button>
						</div>
					</form>
				</mat-step>

				<mat-step label="Select one or more Labels">
					<form>
						<mat-form-field>
							<mat-chip-grid #chipGrid aria-label="Enter template form keywords">
								@for (keyword of selectedLabels(); track keyword) {
									<mat-chip-row (removed)="removeKeyword(keyword)">
										{{ keyword }}
										<button
											matChipRemove
											aria-label="'remove template form' + keyword"
										>
											<mat-icon>cancel</mat-icon>
										</button>
									</mat-chip-row>
								}

								<input
									name="currentLabel"
									placeholder="Add label"
									#labelInput
									[formControl]="currentLabel"
									[matChipInputFor]="chipGrid"
									[matAutocomplete]="auto"
									[matChipInputSeparatorKeyCodes]="separatorKeysCodes"
									(matChipInputTokenEnd)="addKeywordInputEvent($event)"
								/>
								<mat-autocomplete #auto="matAutocomplete">
									@for (label of filteredLabels(); track label) {
										<mat-option
											(onSelectionChange)="addKeywordFromOption($event)"
											[value]="label"
											>{{ label }}</mat-option
										>
									}
								</mat-autocomplete>
							</mat-chip-grid>
						</mat-form-field>

						<div>
							<ng-content select="[selector]"></ng-content>
							<button type="button" mat-button matStepperPrevious>Back</button>
							<button type="button" mat-button matStepperNext>Next</button>
						</div>
					</form>
				</mat-step>

				<mat-step label="Where to apply">
					@switch (selectedOption()) {
						@case (WHAT_TO_DO_OPTIONS.attachment) {
							<div class="drive-picker-container">
								<button mat-raised-button (click)="openPicker()">
									Select Google Drive Folders
								</button>
								@if (selectedFolders().length > 0) {
									<mat-chip-listbox>
										@for (folder of selectedFolders(); track folder.id) {
											<mat-chip>{{ folder.name }}</mat-chip>
										}
									</mat-chip-listbox>
								}
							</div>
						}
						@case (WHAT_TO_DO_OPTIONS.content) {
							OPCIONES DE Contenido
						}
						@case (WHAT_TO_DO_OPTIONS.summary) {
							OPCIONES DE Resumen
						}
						@case (WHAT_TO_DO_OPTIONS.dates) {
							OPCIONES DE Fechas
						}
					}
				</mat-step>

				<mat-step>
					<ng-template matStepLabel>Done</ng-template>
					<p class="done">You are now done.</p>
					<div>
						<button mat-button matStepperPrevious>Back</button>
					</div>
				</mat-step>
			</mat-stepper>
		</mat-card-content>
	</mat-card>
</section>
